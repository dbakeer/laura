"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}();!function($){var e=function(){function e(t,i){_classCallCheck(this,e),this.$element=t,this.options=$.extend({},e.defaults,this.$element.data(),i),this._init(),Foundation.registerPlugin(this,"Equalizer")}return _createClass(e,[{key:"_init",value:function e(){var t=this.$element.attr("data-equalizer")||"",i=this.$element.find('[data-equalizer-watch="'+t+'"]');this.$watched=i.length?i:this.$element.find("[data-equalizer-watch]"),this.$element.attr("data-resize",t||Foundation.GetYoDigits(6,"eq")),this.hasNested=this.$element.find("[data-equalizer]").length>0,this.isNested=this.$element.parentsUntil(document.body,"[data-equalizer]").length>0,this.isOn=!1;var s=this.$element.find("img"),a;this.options.equalizeOn?(a=this._checkMQ(),$(window).on("changed.zf.mediaquery",this._checkMQ.bind(this))):this._events(),(void 0!==a&&!1===a||void 0===a)&&(s.length?Foundation.onImagesLoaded(s,this._reflow.bind(this)):this._reflow())}},{key:"_pauseEvents",value:function e(){this.isOn=!1,this.$element.off(".zf.equalizer resizeme.zf.trigger")}},{key:"_events",value:function e(){var t=this;this._pauseEvents(),this.hasNested?this.$element.on("postequalized.zf.equalizer",function(e){e.target!==t.$element[0]&&t._reflow()}):this.$element.on("resizeme.zf.trigger",this._reflow.bind(this)),this.isOn=!0}},{key:"_checkMQ",value:function e(){var t=!Foundation.MediaQuery.atLeast(this.options.equalizeOn);return t?this.isOn&&(this._pauseEvents(),this.$watched.css("height","auto")):this.isOn||this._events(),t}},{key:"_killswitch",value:function e(){}},{key:"_reflow",value:function e(){if(!this.options.equalizeOnStack&&this._isStacked())return this.$watched.css("height","auto"),!1;this.options.equalizeByRow?this.getHeightsByRow(this.applyHeightByRow.bind(this)):this.getHeights(this.applyHeight.bind(this))}},{key:"_isStacked",value:function e(){return this.$watched[0].offsetTop!==this.$watched[1].offsetTop}},{key:"getHeights",value:function e(t){for(var i=[],s=0,a=this.$watched.length;s<a;s++)this.$watched[s].style.height="auto",i.push(this.$watched[s].offsetHeight);t(i)}},{key:"getHeightsByRow",value:function e(t){var i=this.$watched.length?this.$watched.first().offset().top:0,s=[],a=0;s[a]=[];for(var n=0,h=this.$watched.length;n<h;n++){this.$watched[n].style.height="auto";var l=$(this.$watched[n]).offset().top;l!=i&&(a++,s[a]=[],i=l),s[a].push([this.$watched[n],this.$watched[n].offsetHeight])}for(var r=0,u=s.length;r<u;r++){var o=$(s[r]).map(function(){return this[1]}).get(),c=Math.max.apply(null,o);s[r].push(c)}t(s)}},{key:"applyHeight",value:function e(t){var i=Math.max.apply(null,t);this.$element.trigger("preequalized.zf.equalizer"),this.$watched.css("height",i),this.$element.trigger("postequalized.zf.equalizer")}},{key:"applyHeightByRow",value:function e(t){this.$element.trigger("preequalized.zf.equalizer");for(var i=0,s=t.length;i<s;i++){var a=t[i].length,n=t[i][a-1];if(a<=2)$(t[i][0][0]).css({height:"auto"});else{this.$element.trigger("preequalizedrow.zf.equalizer");for(var h=0,l=a-1;h<l;h++)$(t[i][h][0]).css({height:n});this.$element.trigger("postequalizedrow.zf.equalizer")}}this.$element.trigger("postequalized.zf.equalizer")}},{key:"destroy",value:function e(){this._pauseEvents(),this.$watched.css("height","auto"),Foundation.unregisterPlugin(this)}}]),e}();e.defaults={equalizeOnStack:!0,equalizeByRow:!1,equalizeOn:""},Foundation.plugin(e,"Equalizer")}(jQuery);